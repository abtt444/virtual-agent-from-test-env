<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_cb_design_topic">
    <sys_cb_design_topic action="INSERT_OR_UPDATE">
        <compiled_topic display_value="New FallBack working - backup">abaa8b0e87569910c386fd99cebb359b</compiled_topic>
        <design_definition>{"type":"FlowTopic","triggers":[{"type":"Trigger","name":"8eec4a0d3c4f4909b72b341ff7cdfe49","triggerType":"request","applicability":{"type":"Applicability","mode":"script","value":"true"},"id":"8eec4a0d3c4f4909b72b341ff7cdfe49"}],"goals":[{"name":"primary","trigger_id":"8eec4a0d3c4f4909b72b341ff7cdfe49","nodes":[{"type":"StartGoal","goal_id":"primary","greeting_msg":{"type":"String","mode":"string","value":""},"id":"686ab061d0bf47cc9c21b642ed6ceddc","name":"Start"},{"type":"TerminateGoal","goal_id":"primary","confirmation_msg":{"type":"String","mode":"string","value":""},"id":"893c6a1338c7416ba3925102c72d1742","name":"End"},{"type":"Decision","name":"Did the search return results?","branches":[{"type":"Branch","label":"Found one","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    if(vaVars.searchResultCount === 1) {\n        vaVars.results_returned = true;\n        vaVars.selected_faq = 0;\n        vaVars.selected_type = 'single';\n        return true;\n    }\n    return false;\n})()\n"},"id":"2c4822ad46944fdead3cbca152023980","name":"Found one"},{"type":"Branch","label":"No","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    if (!(vaVars.searchResultCount &gt; 0)) {\n        vaVars.results_helpful = false;\n        vaVars.results_returned = false;\n        return true;\n    }\n    return false;\n\n})()\n"},"id":"f310421c916a41439f24680fa4d82dfd","name":"No"},{"type":"Branch","label":"More than one","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return vaVars._topic_strategy == 'unknown';\n})()\n"},"id":"8acea6e8335b4ccd8ab889f6f7003b9d","name":"More than one"}],"id":"cb323830d96e4887a125c669d9f1cbb5","goal_id":"primary"},{"type":"ScriptedAction","script":"(function execute() {\n    var contextualSearch = new global.VAGlobalContextualSearchUtil();\n    vaVars.user_search_text = vaSystem.getSearchText().trim();\n    var response = contextualSearch.search(\n        vaVars.search_context_sys_id, vaVars.user_search_text, vaInputs.kb_knowledge_base\n    );\n    var success = contextualSearch.processSearchResponse(response);\n    if (!success) {\n        return;\n    }\n\n    var relevantSearchResults = contextualSearch.processGeneralResults(response, 6, -2);\n    vaVars.searchResultCount = relevantSearchResults.length;\n    vaVars.search_result_json_string = JSON.stringify(relevantSearchResults);\n    vaVars.index = 0;\n    return;\n})()\n","id":"ce2f19cc278045d1bb2e19248112425a","name":"Conversation Builder","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"OutputPrompt","value":{"type":"String","mode":"string","value":"gs.getMessageLang(\"I found this information that might help you\", vaContext.getRequesterLang())"},"id":"f5831de556634262aeb36d1128fe4a1f","name":"Found Information","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"},"secure":false},{"type":"ReferenceChoiceInputPrompt","mode":"external","id":"3f38839938994d7e84d5f3a5f405f20a","name":"Choose Article","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"},"variable_id":"f84c7bc5da5045619161e1521eabe6b4","message":{"type":"String","mode":"string","value":"gs.getMessageLang(\"I found some information that might help you\", vaContext.getRequesterLang())"},"skippable":{"type":"Applicability","mode":"script","value":"false"},"nlu_entity_binding":{"type":"NLUEntityBinding","allow_text_input":false,"use_confirmation_prompt":true},"expression_mode":"script","script":"(function execute() {\n    var options = [];\n    var searchJsonObj = JSON.parse(vaVars.search_result_json_string);\n\n    for (i = 0; i &lt; searchJsonObj.length; i++) {\n        options.push({ 'value': i, 'label': searchJsonObj[i].title });\n    }\n\n    options.push({ 'value': '-1', 'label': 'I\\'m looking for something else' })\n\n    return options;\n})()\n","metadataScript":"","cardName":"","cardFields":[],"no_options_found_message":{"type":"String","mode":"string","value":"gs.getMessageLang(\"No records found.\", vaContext.getRequesterLang())"},"condition":{"type":"Condition","mode":"external_script","value":"(function execute() {\n    var options = [];\n    var searchJsonObj = JSON.parse(vaVars.search_result_json_string);\n\n    for (i = 0; i &lt; searchJsonObj.length; i++) {\n        options.push({ 'value': i, 'label': searchJsonObj[i].title });\n    }\n\n    options.push({ 'value': '-1', 'label': 'I\\'m looking for something else' })\n\n    return options;\n})()\n"}},{"type":"OutputPrompt","value":{"type":"String","mode":"script","value":"(function execute() {\n    \n   // relevant properties to get record\n    var searchJsonObj = JSON.parse(vaVars.search_result_json_string);\n    var resultNumber = searchJsonObj[vaVars.selected_faq].meta.number;\n    gs.info('cw:resultNumber ' + resultNumber);\n\n   // var faqUtil = new global.VAFaqUtil();\n    // build the header text\n   // header_text =  faqUtil.buildHeaderText(resultNumber, vaVars.selected_type);\n  gs.info('cw:choose_article' + resultNumber);\nvar getKBArticle = new GlideRecord('kb_knowledge');\ngetKBArticle.get('number', resultNumber);\nvar description = getKBArticle.getValue('text').replace(/(&lt;([^&gt;]+)&gt;)/gi, \"\");\n//if(description.length &gt; 80) \n//{   \n// description = description.slice(0, 78); \nvaVars.description = description;\nvaVars.short_description = getKBArticle.getValue('short_description');\n\n//}\n\n  header_text = resultNumber + '&lt;br&gt;&lt;br&gt;'+vaVars.short_description;  \n    header_text += '&lt;br&gt;&lt;br&gt;';\ngs.info('cw: vaVars.selected_faq:'  + vaVars.selected_faq);\n    var linkBuilder = new global.cxs_SearchResultLinkBuilder();\n    var link = linkBuilder.build(searchJsonObj[vaVars.selected_faq], vaInputs.portal);\ngs.info('cw: link.link' + link.link);\n    //header_text += '&lt;a href=\"'+link.link+'\" target=\"_blank\" &gt;'+ 'Read full article'+ '&lt;/a&gt;';\nheader_text += '&lt;a href=\"'+\"myhrportal?id=kb_article_view&amp;sysparm_article=\" + resultNumber +'\" target=\"_blank\" &gt;'+ 'Read full article'+ '&lt;/a&gt;';\n   // &lt;p&gt;&lt;a href=\"cep?id=kb_article_view&amp;sysparm_article={{vaInputs.show_knowledge_blocks.number}}\" target=\"_blank\"&gt;More Details&lt;/a&gt;&lt;/p&gt;\n    //header_text += '[Read full article]('+link.link+')'\n    return header_text;\n    gs.info('hello');\n})()\n"},"id":"d66b47bd818f45708072fa9a403816ab","name":"Display article","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"},"secure":false},{"type":"InputPrompt","variable_id":"d6fc2b007bf44020847d2910948f0f20","message":{"type":"String","mode":"string","value":"gs.getMessageLang(\"Did this information help you?\", vaContext.getRequesterLang())"},"nlu_entity_binding":{"type":"NLUEntityBinding","allow_text_input":false,"use_confirmation_prompt":true},"skippable":{"type":"Applicability","mode":"script","value":"false"},"id":"badde888150c4a8f8a55b1ea72ea4025","name":"Did the info help","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"ScriptedAction","script":"(function execute() {\n    if(vaInputs.did_info_help == 'true') {\n        vaVars.results_helpful = true;\n    } else {\n        vaVars.results_helpful = false;\n    }\n})()\n","id":"23c9bffacddf41ada6a0982c562da1ec","name":"Record Outputs","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"Decision","name":"Decision","branches":[{"type":"Branch","label":"Selected one","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    if (vaInputs.choose_article.getValue() != '-1') {\n        // need parseInt because it was keeping decimals\n        vaVars.selected_faq = parseInt(vaInputs.choose_article.getValue());\n        vaVars.selected_type = 'multi';\n        return true;\n    }\n    return false;\n})()\n"},"id":"327ec9ce756d4280b2732070de76d0cc","name":"Selected one"},{"type":"Branch","label":"Something else","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return vaInputs.choose_article.getValue() == '-1';\n})()\n"},"id":"c76b072215c342b1996900b6da05a793","name":"Something else"}],"id":"562e98cc9dec42c885858cd36d892a46","goal_id":"primary"}],"edges":[{"type":"Edge","source_node_id":"3f38839938994d7e84d5f3a5f405f20a","target_node_id":"562e98cc9dec42c885858cd36d892a46","id":"923aecb91db14bc0982983b1d5f821c5"},{"type":"Edge","source_node_id":"cb323830d96e4887a125c669d9f1cbb5","target_node_id":"f5831de556634262aeb36d1128fe4a1f","branch_id":"2c4822ad46944fdead3cbca152023980","id":"cc1fc572301844768bc7d38a775648da","name":"2c4822ad46944fdead3cbca152023980"},{"type":"Edge","source_node_id":"ce2f19cc278045d1bb2e19248112425a","target_node_id":"cb323830d96e4887a125c669d9f1cbb5","id":"d28b6822964249598eeb056bdff29f68"},{"type":"Edge","source_node_id":"686ab061d0bf47cc9c21b642ed6ceddc","target_node_id":"ce2f19cc278045d1bb2e19248112425a","id":"f408b9d5c888429fb68b597faafb2e2c"},{"type":"Edge","source_node_id":"cb323830d96e4887a125c669d9f1cbb5","target_node_id":"893c6a1338c7416ba3925102c72d1742","branch_id":"f310421c916a41439f24680fa4d82dfd","id":"535afddfc3c14d0c87a5e69b85c0e7ec","name":"f310421c916a41439f24680fa4d82dfd"},{"type":"Edge","source_node_id":"cb323830d96e4887a125c669d9f1cbb5","target_node_id":"3f38839938994d7e84d5f3a5f405f20a","branch_id":"8acea6e8335b4ccd8ab889f6f7003b9d","id":"80fdc9f9efd3480788c8df42c65b8f5d","name":"8acea6e8335b4ccd8ab889f6f7003b9d"},{"type":"Edge","source_node_id":"f5831de556634262aeb36d1128fe4a1f","target_node_id":"d66b47bd818f45708072fa9a403816ab","id":"9d9d0d5831354c4d8994357a274cd1bf"},{"type":"Edge","source_node_id":"d66b47bd818f45708072fa9a403816ab","target_node_id":"badde888150c4a8f8a55b1ea72ea4025","id":"b0d268b566b84b379eea4e7bff5a139a"},{"type":"Edge","source_node_id":"badde888150c4a8f8a55b1ea72ea4025","target_node_id":"23c9bffacddf41ada6a0982c562da1ec","id":"28982c88f4fb45fcb6412e6a4374bf45"},{"type":"Edge","source_node_id":"23c9bffacddf41ada6a0982c562da1ec","target_node_id":"893c6a1338c7416ba3925102c72d1742","id":"ec3f40495e5047d6955ab04c60a8d255"},{"type":"Edge","source_node_id":"562e98cc9dec42c885858cd36d892a46","target_node_id":"d66b47bd818f45708072fa9a403816ab","branch_id":"327ec9ce756d4280b2732070de76d0cc","id":"d24ad83d3e774fcc86a871eebe759d8f","name":"327ec9ce756d4280b2732070de76d0cc"},{"type":"Edge","source_node_id":"562e98cc9dec42c885858cd36d892a46","target_node_id":"893c6a1338c7416ba3925102c72d1742","branch_id":"c76b072215c342b1996900b6da05a793","id":"e946c01683e54d8bbc43234461e77457","name":"c76b072215c342b1996900b6da05a793"}],"id":"primary"}],"script_variables":[{"type":"String","name":"_topic_strategy","value":{"type":"String","mode":"string"},"list":false,"id":"09bf8a0898e04c48a34600a1509d3d05","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"user_search_text","value":{"type":"String","mode":"string"},"list":false,"id":"cf5b773f56164bac87bb53f1fddbd129","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"_topic_wrong_msg","value":{"type":"String","mode":"string"},"list":false,"id":"1ad3b767fea64b3087c180011d69026c","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"topic_not_found","value":{"type":"String","mode":"script","value":"(function execute() {\n    return gs.getMessage(\"Sorry I didn't find something that helped. {0}\", vaVars._topic_not_found_msg);\n})()\n"},"list":false,"id":"1b26fecc9ac640b1979ef02089edbdb9","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"_setup_explore_help_topic","value":{"type":"String","mode":"string"},"list":false,"id":"431db36d85a2447b879ea86552c68109","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"_topic_not_found_msg","value":{"type":"String","mode":"string"},"list":false,"id":"a02d5dd3d61e4d81981fc3772a56da08","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"DEBUG_JSON_RESULT","value":{"type":"String","mode":"string"},"list":false,"id":"0abb7558f292421d95bcd3b3f845814b","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"index","value":{"type":"String","mode":"string"},"list":false,"id":"31bb58fa6bfb4b439ceceff6a09868a2","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"limit","value":{"type":"String","mode":"string","value":"3"},"list":false,"id":"5cf1ff0f732641ad82c144d203be970f","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"results_helpful","value":{"type":"String","mode":"string","value":"false"},"list":false,"id":"e75fd46b724745638452d3cf499d58b0","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"search_context_sys_id","value":{"type":"String","mode":"string","value":"d51b7504eb53210070a9666cd206feff"},"list":false,"id":"22b5a13f11b04ef68dd3cb7fe466cf24","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"selected_faq","value":{"type":"String","mode":"string"},"list":false,"id":"465371b15d7947e280a0319b73be7459","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"selected_type","value":{"type":"String","mode":"script","value":"(function execute() {\n    return 'none';\n})()\n"},"list":false,"id":"084d6ca7a1ce40eca8a4263b9143aa74","formatType":"text","secure":false,"sensitive":false}],"glide_variables":[{"type":"Reference","table":"sys_user","id":"8c424f2fb6fc4c169ca85845dbfe3a6e","name":"user","formatType":"text","secure":false,"sensitive":false,"list":false},{"type":"Choice","choices":[],"id":"f84c7bc5da5045619161e1521eabe6b4","name":"choose_article","formatType":"text","secure":false,"sensitive":false,"list":false,"table":""},{"type":"True/False","id":"d6fc2b007bf44020847d2910948f0f20","name":"did_the_info_help","formatType":"text","secure":false,"sensitive":false,"list":false}],"applicability":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return false;\n})()\n"},"roles":["public"],"scope":"4a28375b1bedec54ef5b635ee54bcba5","domain":"global","topic_type":"SETUP_TOPIC","channels":[],"id":"d31aa8fc97021910fac1f386f053afd8","name":"New FallBack working - backup","key_phrases":["New FallBack working - backup","New Fall backup 1.0","New Fallback backup","New Fallback","Search Fallback Topic."," Fallback Topic"],"nlu_provider":"","nlu_model":"","nlu_model_label":"","nlu_intent":"","nlu_intent_label":"","flexible_conversation_switching":false,"autopilot_topic":false,"design_categories":[],"triggerable_by_notification":false,"library":false,"readOnly":false,"nluMapping":"[]"}</design_definition>
        <design_topic_id>d31aa8fc97021910fac1f386f053afd8</design_topic_id>
        <name>New FallBack working - backup</name>
        <sys_class_name>sys_cb_design_topic</sys_class_name>
        <sys_created_by>thabiso.diphare</sys_created_by>
        <sys_created_on>2022-10-04 08:08:52</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_id>e3aa8f0e87569910c386fd99cebb355f</sys_id>
        <sys_mod_count>4</sys_mod_count>
        <sys_name>FlowTopic</sys_name>
        <sys_package display_value="Absa HR NLU Models" source="x_absa2_absa_hr_nl">4a28375b1bedec54ef5b635ee54bcba5</sys_package>
        <sys_policy/>
        <sys_scope display_value="Absa HR NLU Models">4a28375b1bedec54ef5b635ee54bcba5</sys_scope>
        <sys_update_name>sys_cb_design_topic_e3aa8f0e87569910c386fd99cebb355f</sys_update_name>
        <sys_updated_by>thabiso.diphare</sys_updated_by>
        <sys_updated_on>2022-10-04 08:19:49</sys_updated_on>
        <type>FlowTopic</type>
    </sys_cb_design_topic>
</record_update>
